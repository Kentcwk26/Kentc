FUNCTION login()
    print("NEWLINE Welcome to Tenant Management System Login page. NEWLINE Please enter username and password to proceed.NEWLINE")
    chance=3
    WHILE chance>0
        PRINT("Enter username:")
        GET username
        PRINT("Enter password:")
        GET password
        OPENFILE (username.txt) IN READ MODE AS userInfo
            userCheck = READ userInfo LINE-BY-LINE()
            FOR record in userCheck
                listRecord = SPLIT record INTO LIST SEPARATED BY ","
                IF username == listRecord LOCATION 0 THEN
                    IF password == listRecord LOCATION 1 THEN
                        print("\nLogin successful\n")
                        IF (username == "john" AND password == "1234u-78") OR (username == "david" AND password == "55467913"):
                            masterKey = TRUE
                        ELSE THEN
                            masterKey = FALSE
                        CALLFUNCTION menu(masterKey)
                        chance = 0
                        BREAKLOOP
                        ENDIF
                    ENDIF
                ELSE THEN
                    chance -= 1
                    PRINT("Error, incorrect username or password."\n ,chance,"chances remaining"\n)
                    BREAKLOOP
                ENDIF
            ENDFOR
        CLOSEFILE
    ENDWHILE
ENDFUNCTION

FUNCTION transactionEntryForm()
ENDFUNCTION

FUNCTION log()
ENDFUNCTION

FUNCTION tenantRead()
    OPENFILE (tenant.txt) IN READ MODE AS fTenant
        tenantList = READ fTenant LINE-BY-LINE
        FOR record IN tenantList
            PRINT(record RIGHTSTRIP(",") RIGHTSTRIP("\n"))
        ENDFOR
    CLOSEFILE
ENDFUNCTION

FUNCTION tenantEntryForm(tenantlist,n)
    for i in range(n)
        newForm=[]
        name = CALL FUNCTION getname()
        gender = CALLFUNCTION getgender()
        pNum = CALLFUNCTION getpNum()
        nationality = CALLFUNCTION getnationality()
        startDate = CALLFUNCTION getstartDate()
        income = CALLFUNCTION getincome()
        rental = CALLFUNCTION getrental()
        APPEND [name,gender,pNum,nationality,startDate,income,rental] TO tenantList
    RETURN tenantList
ENDFUNCTION

FUNCTION getname()
    WHILE TRUE
        PRINT("Enter tenant name: Firstname Familyname Lastname"\n)
        GET name
        nameCheck = name
        SPLIT nameCheck INTO LIST WITH ","
        FOR words IN nameCheck
            IF words LOCATION 0 IS UPPERCASE THEN
                BREAKLOOP
            ELSE THEN
                code = 2
                CALLFUNCTION message(code)
            ENDIF
        ENDFOR
    ENDWHILE
    RETURN name
ENDFUNCTION

FUNCTION getgender()
    PRINT("Enter tenant gender: (m/f):\n")
    GET gender
    genderCheck = gender
    IF genderCheck LENGTH == 1 THEN
        IF genderCheck IS NOT A NUMBER THEN
            BREAKLOOP
        ELSE THEN
            code = 1
            CALLFUNCTION message(code)
    ELSE THEN
        code = 3
        CALLFUNCTION message(code)
    RETURN gender
ENDFUNCTION

FUNCTION getpNum():
    PRINT("Enter tenant phone number: (############):\n")
    GET pNum
    pNumCheck=pNum
    FOR digit IN pNum
        IF digit IS INTEGER THEN
            BREAKLOOP
        ELSE THEN
            code = 1
            CALLFUNCTION message(code)
        ENDIF
    ENDFOR
    RETURN pNum
ENDFUNCTION

FUNCTION getnationality():
    PRINT("Enter tenant nationality: (M: Malaysian/N: non-Malaysian):\n")
    GET nationality
    nationality = nationalityCheck
    IF nationalityCheck LENGTH = 1 THEN
        BREAKLOOP
    ELSE THEN 

    RETURN nationality
ENDFUNCTION

FUNCTION getstartDate():
    PRINT("Enter Rental start date: (YYYY,MM,DD):\n")
    GET startDate
    RETURN startDate
ENDFUNCTION

FUNCTION getincome():
    PRINT("Enter tenant income range(RM):\n")
    GET income
    RETURN income
ENDFUNCTION

FUNCTION getrental():
ENDFUNCTION

FUNCTION deleteTenant(recordName, recordNum)
    IF recordName==tenant
        OPEN "tenant.txt" IN READ MODE AS Thandler
            READ Thandler
            Thandler STRIP (",") 
            FOR record from list
                FOR item in record
                
FUNCTION searchTenant(details):
    OPEN "tenant.txt" IN READ MODE AS TSearch
        READ TSearch
        TSearch STRIP (",")
        list = JOIN TSearch INTO string(",")
        FOR record IN list
            IF record STARTS WITH details THEN
                PRINT("Found record", record RIGHTSTRIP(",") RIGHTSTRIP(""))
            ENDIF
        ENDFOR
    CLOSEFILE

FUNCTION appendFile(list, listCode)
    IF listCode == T THEN
        OPEN "tenant.txt" IN APPEND AS TAppend
            for record from list
                for item in record
                    WRITE item TO TAppend
                    WRITE "\n" TO TAppend
                WRITE "\n" TO TAppend
        CLOSEFILE
    ELSE IF listCode == A THEN
        OPEN "apartment.txt" IN APPEND AS AAppend
            for record from list
                for item in record
                    WRITE item TO AAppend
                    WRITE "\n" TO AAppend
                WRITE "\n" TO AAppend
        CLOSEFILE
    ELSE THEN
        OPEN "transaction.txt" IN APPEND AS PAppend
            for record from list
                for item in record
                    WRITE item TO PAppend
                    WRITE "\n" TO PAppend
                WRITE "\n" TO PAppend

FUNCTION read_file(listCode):
    IF listCode == TRUE:
        OPEN "tenant.txt" IN READ AS Thandler:
            FOR record FROM Ahandler:
                PRINT(record RIGHTSTRIP() RIGHTSTRIP(","))

    ELSE:
        OPEN "apartment.txt" IN READ AS Ahandler:
            FOR record FROM Ahandler:
                PRINT(record RIGHTSTRIP() RIGHTSTRIP(","))

FUNCTION message(code)
    IF code == 0:
        PRINT("Incorrect input")
    ELSE IF code == 1:
        PRINT("Incorrect data type present")
    ELSE IF code == 2:
        PRINT("Format error")
    ELSE IF code == 3:
        PRINT("Length error")
    PRINT("Please try again.")

--------------------------------------------------------------------------------------------------------------------------------------------------------------------

FUNCTION adminApartment():
    
    PRINT("NEWLINE Apartment Info: NEWLINE")
    record=[]

    list1=[["Standard Room (Triple)"],["Code: SR1"],["Dimensions: 140+ sqft"],["Pricing: RM350"],["Number of Rooms: 20"],["Apartment ID: A01-L1-R1 to A01-L1-R21"]]
    list2=[["Standard Room (Twin)"],["Code: SR2"],["Dimensions: 120+ sqft"],["Pricing: RM450"],["Number of Rooms: 20"],["Apartment ID: A01-L1-R22 to A01-L1-R41"]]
    list3=[["Standard Room A/C (Triple)"],["Code: SR3"],["Dimensions: 150+ sqft"],["Pricing: RM550"],["Number of Rooms: 20"],["Apartment ID: A01-L2-R1 to A01-L2-R21"]]
    list4=[["Standard Room A/C (Twin)"],["Code: SR4"],["Dimensions: 130+ sqft"],["Pricing: RM650"],["Number of Rooms: 20"],["Apartment ID: A01-L2-R22 to A01-L2-R41"]]
    list5=[["Deluxe Room (Triple)"],["Code: DR1"],["Dimensions: 170+ sqft"],["Pricing: RM750"],["Number of Rooms: 20"],["Apartment ID: A01-L4-R1 to A01-L4-R21"]]
    list6=[["Deluxe Room (Twin)"],["Code: DR2"],["Dimensions: 160+ sqft"],["Pricing: RM840"],["Number of Rooms: 20"],["Apartment ID: A01-L4-R22 to A01-L4-R41"]]
    list7=[["Deluxe Room A/C with shared attached bath / toilet (Triple)"],["Code: DR3"],["Dimensions: 180+ sqft"],["Pricing: RM950"],["Number of Rooms: 20"],["Apartment ID: A01-L3-R1 to A01-L3-R21"]]
    list8=[["Deluxe Room A/C with shared attached bath / toilet"],["Code: DR4"],["Dimensions: 170+ sqft"],["Pricing: RM1040"],["Number of Rooms: 20"],["Apartment ID: A01-L3-R22 to A01-L3-R41"]]
    list9=[["Compact Premium Single"],["Code: CPS"],["Dimensions: 130+ sqft"],["Pricing: RM690"],["Number of Rooms: 20"],["Apartment ID: A01-L5-R1 to A01-L5-R41"]]
    list10=[["Medium Premium Single"],["Code: MPS"],["Dimensions: 150+ sqft"],["Pricing: RM750"],["Number of Rooms: 20"],["Apartment ID: A02-L1-R1 to A02-L1-R21"]]
    list11=[["Medium Premium Twin"],["Code: MPT"],["Dimensions: 180+ sqft"],["Pricing: RM890"],["Number of Rooms: 20"],["Apartment ID: A02-L2-R1 to A02-L2-R21"]]
    list12=[["Medium Premium with attached bath / toilet (Twin)"],["Code: MP1"],["Dimensions: 180+ sqft"],["Pricing: RM940"],["Number of Rooms: 20"],["Apartment ID: A02-L3-R1 to A02-L3-R21"]]
    list13=[["Medium Premium with attached bath / toilet (Single)"],["Code: MP2"],["Dimensions: 160+ sqft"],["Pricing: RM1050"],["Number of Rooms: 20"],["Apartment ID: A02-L3-R22 to A02-L3-R41"]]
    list14=[["En-Suite Single (Super Premium - Triple)"],["Code: ESS3"],["Dimensions: 160+ sqft"],["Pricing: RM700"],["Number of Rooms: 20"],["Apartment ID: A02-L4-R1 to A02-L4-R41"]]
    list15=[["En-Suite Single (Super Premium - Twin)"],["Code: ESS2"],["Dimensions: 140+ sqft"],["Pricing: RM800"],["Number of Rooms: 20"],["Apartment ID: A02-L4-R1 to A02-L4-R41"]]
    list16=[["En-Suite Twin (Super Premium)"],["Code: EST2"],["Dimensions: 200+ sqft"],["Pricing: RM900"],["Number of Rooms: 20"],["Apartment ID: A02-L5-R1 to A02-L5-R41"]]
    APPEND [list1,list2,list3,list4,list5,list6,list7,list8,list9,list10,list11,list12,list13,list14,list15,list16] TO record

    OPEN "Apartment.txt" IN WRITE AS Ahandler
        for item in record:
            for data in item:
                for element in data:
                    WRITE element TO Ahandler
                WRITE ", " TO Ahandler
            WRITE "\n" TO Ahandler
    CLOSE apartment.txt

    OPEN "Apartment.txt" IN READ AS Ahandler
        for item in Ahandler:
            PRINT(item,RIGHTSTRIP() RIGHTSTRIP(","))
    CLOSE apartment.txt

    CALLFUNCTIONmodifydata()

ENDFUNCTION

FUNCTION modifydata():

    DECLARE dataInput AS INTEGER
    WHILE TRUE:
    PRINT("NEWLINE 1. Add data NEWLINE 2. Edit Data NEWLINE 3. Delete Data NEWLINE 4. Exit NEWLINE")
    PRINT("Please select which operation: ")
    GET dataInput

    IF dataInput==1 THEN
        PRINT("NEWLINE Add Data NEWLINE")
        CALLFUNCTION apartmentAddData()

    ELSE IF dataInput==2 THEN
        PRINT("NEWLINE Add Data NEWLINE")
        CALLFUNCTION apartmentEditData()

    ELSE IF dataInput==3 THEN
        PRINT("NEWLINE Add Data NEWLINE")
        CALLFUNCTION apartmentDeleteData()

    ELSE IF dataInput==4 THEN
        PRINT("Exit")
        RETURN FALSE

    ELSE THEN
        PRINT("Error!")
        RETURN TRUE

ENDFUNCTION

FUNCTION apartmentAddData():
    
    WHILE TRUE:
    DECLARE adddatanum,newapartmentnumberofrooms,adddataconfirmation,rewritedataconfirmation AS INTEGER
    DEFINE adddata AS ARRAY

    PRINT("NEWLINE Now, you are required to enter the new data NEWLINE")

    FOR i FROM 0 to adddatanum

        PRINT("Apartment: ")
        GET newapartment
        PRINT("Code: ")
        GET newapartmentcode
        PRINT("Dimension (in range): ")
        GET newapartmentdimension
        PRINT("Pricing in RM:")
        GET newapartmentpricing
        PRINT("Number of rooms: ")
        GET newapartmentnumberofrooms
        PRINT("Apartment ID: ")
        GEt newapartmentID
        APPEND [newapartment,newapartmentcode,newapartmentdimension,newapartmentpricing,newapartmentnumberofrooms,newapartmentID] TO adddata
        PRINT(NEWLINE, adddata, NEWLINE)

    ENDFOR

        PRINT("Are you sure with the records you inserted just now? Enter '1' to save record, Enter '0' to unsave record: )
        GET adddataconfirmation

        IF adddataconfirmation == 1 THEN

            PRINT("NEWLINE Data Saved NEWLINE ")
            RETURN FALSE

        ELSE IF adddataconfirmation == 0 THEN

            PRINT("NEWLINE Enter 'W' to rewrite the data again, Enter any key to exit: ")
            GET rewritedataconfirmation
            IF rewritedataconfirmation == 'W' THEN
                RETURN TRUE
            ELSE:
                PRINT("Return to main menu....")
                RETURN FALSE
            ENDIF

        ELSE:
            PRINT("NEWLINE Invalid input")
            RETURN TRUE

        ENDIF

ENDFUNCTION

FUNCTIONapartmentEditData():
ENDFUNCTION

FUNCTIONapartmentDeleteData():
ENDFUNCTION

FUNCTION searchbox():

    WHILE TRUE
        DECLARE option AS INTEGER
        DECLARE opt AS STRING
        PRINT("NEWLINE Welcome to search box!")
        PRINT("NEWLINE 1. Search room specific details.NEWLINE 2. Search specific tenant details NEWLINE 4. Exit NEWLINE")
        PRINT("Please type the keyword search based on the listing above: ")
        GET option

        IF option=='1' THEN

            PRINT("NEWLINE Room(r), Pricing(p)\nPlease type the keyword search based on the listing above: ")
            GET opt

            IF opt=='r' THEN
            PRINT("NEWLINE SR1,SR2,SR3,SR4,DR1,DR2,DR3,DR4,CPS,MPS,MPT,MP1,MP2,ESS3,ESS2,EST2.... NEWLINE Please enter the apartment code to begin the search: ")
            num=1
            CALLFUNCTION searchinformation(num)

            ELSEIF opt=='p' THEN
            PRINT("NEWLINE RM350,RM450,RM550,RM650,RM690,RM700,RM750,RM800,RM840,RM890,RM900,RM940,RM950,RM1040,RM1050.... NEWLINE Please enter the pricing to begin the search: ")
            num=3
            CALLFUNCTION searchinformation(num)

            ELSE:
            PRINT("Invalid input or no records")
            PRINT("Continue? Enter 'C' NEWLINE Exit? Enter 'X' ")

            ENDIF

        ELSE IF option=='2' THEN

            PRINT("NEWLINE Name(N),Apartment Details(A) NEWLINE Please type the keyword search based on the listing above: ")
            GET options

            IF options=='N' THEN
                PRINT()

            ELSEIF opt=='A' THEN
                PRINT()

            ELSE:
                PRINT("Invalid input or no records")

            ENDIF

        ELSE IF option=='X' THEN

            PRINT(" NEWLINE Return to main menu NEWLINE NEWLINE --------------------------- ")
            RETURN FALSE

        ELSE:

            PRINT("NEWLINE Error! Please try again")
            RETURN TRUE

        ENDIF

ENDFUNCTION

FUNCTION searchinformation(num)

    PRINT("Select and enter text to begin search: ")
    GET searchinformation
    PRINT()
    OPEN "Apartment.txt" IN READ AS Xhandler
        FOR record FROM Xhandler:
            strippeditem = record RIGHTSTRIP(",") RIGHTSTRIP("NEWLINE")
            data = SPLIT strippeditem INTO string(",")
            IF searchinformation IN data[num]:
                PRINT("Results: NEWLINE",record)

ENDFUNCTION

FUNCTION menu(masterKey)
    PRINT("NEWLINE - Welcome back, you are now entering Tenant Management System -")

    WHILE TRUE

        IF masterKey == FALSE THEN
            print("NEWLINE [S]-Search box NEWLINE [A]-Review all apartment information NEWLINE [P]-Transaction Details NEWLINE [P]-Print Specific House and Tenant Details NEWLINE [E]-Exit\n")
        ELSE THEN
            PRINT("NEWLINE [S]-Search box NEWLINE [A]-Apartment NEWLINE [T]-Tenant NEWLINE [D]-Print Specific House & Tenant Details NEWLINE [I]-Inquiry of Past Tenant Details NEWLINE [P]-Transaction History NEWLINE [L]-Login History NEWLINE [R]-Register new tenant NEWLINE [E]- Exit")
        PRINT("Please select which operation that you want to do: ")
        GET opt
        
        IF opt IN ["S","s"] THEN

            CALLFUNCTION search()

        ELSE IF opt IN ["A","a"] THEN

            CALLFUNCTION display()
            
        ELSE IF opt IN ["R","r"] AND masterKey == TRUE THEN

            PRINT("Number of new tenants: ")
            GET n
            tenantlist=[]
            tenantlist = CALLFUNCTION tenantEntryForm(tenantlist,n)

            appendFile(tenantlist,n)

        ELSE IF opt IN ["E","e"] THEN:

            PRINT("NEWLINE Thank you for using, have a nice day~ NEWLINE")
            RETURN FALSE

        ELSE:

            code = 3
            CALLFUNCTION message(code)
        ENDIF
    ENDWHILE
ENDFUNCTION


BEGIN
IMPORT datetime AS dt
CALLFUNCTION login()
END
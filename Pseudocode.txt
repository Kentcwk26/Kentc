FUNCTION login()
    chance=3
    WHILE chance>0
        PRINT("Enter username:")
        GET username
        PRINT("Enter password:")
        GET password
        OPENFILE (username.txt) IN READ MODE AS userInfo
            userCheck = READ userInfo LINE-BY-LINE()
            FOR record in userCheck
                listRecord = SPLIT record INTO LIST SEPARATED BY ","
                IF username == listRecord LOCATION 0 THEN
                    IF password == listRecord LOCATION 1 THEN
                        print("\nLogin successful\n")
                        IF (username == "john" AND password == "1234u-78") OR (username == "david" AND password == "55467913"):
                            CALLFUNCTION adminMenu()
                        ELSE THEN
                            CALLFUNCTION tenantMenu()
                        chance = 0
                        BREAKLOOP
                        ENDIF
                    ENDIF
                ELSE THEN
                    chance -= 1
                    PRINT("Error, incorrect username or password."\n ,chance,"chances remaining"\n)
                    BREAKLOOP
                ENDIF
            ENDFOR
        CLOSEFILE
    ENDWHILE
ENDFUNCTION

FUNCTION add()
    WHILE TRUE
        PRINT("[T]-Tenant  NEWLINE [A]-Apartment  NEWLINE [P]-Transaction  NEWLINE [L]-Leave NEWLINE Choose a category:)
        GET category
        IF category IS IN  ("T","t") THEN
            tenantEntryForm()
        ELSE IF category IS IN  ("A","a") THEN
            apartment()
        ELSE IF category IS IN  ("P","p") THEN

        ELSE IF category IS IN  ("L","l") THEN
            RETURN FALSE
        ELSE THEN
            code = 0
            CALLFUNCTION message(code)
        ENDIF
    ENDWHILE
ENDFUNCTION

FUNCTION display()
    WHILE TRUE
        PRINT("[T]-Tenant NEWLINE [A]-Apartment NEWLINE [P]-Transaction NEWLINE [L]-Leave NEWLINE Choose a Category: ")
        GET category
        IF category IS IN  ("T","t") THEN
            CALLFUNCTION tenantRead()
        ELSE IF category IS IN  ("A","a") THEN
            CALLFUNCTION apartment()
        ELSE IF category IS IN  ("P","p") THEN
            CALLFUNCTION transaction()
        ELSE IF category IS IN  ("L","l") THEN
            RETURN FALSE
        ELSE THEN
            code = 0
            CALLFUNCTION message(code)
        ENDIF
    ENDWHILE
ENDFUNCTION

FUNCTION Update()
    WHILE TRUE
        PRINT("[T]-Tenant  NEWLINE [A]-Apartment  NEWLINE [P]-Transaction  NEWLINE [L]-Leave NEWLINE Choose a category:)
        GET category
        IF category IS IN  ("T","t") THEN
            
        ELSE IF category IS IN  ("A","a") THEN

        ELSE IF category IS IN  ("P","p") THEN

        ELSE IF category IS IN  ("L","l") THEN
            RETURN FALSE
        ELSE:
            code = 0
            CALLFUNCTION message(code)
        ENDIF
    ENDWHILE
ENDFUNCTION

FUNCTION delete()
    WHILE TRUE
        PRINT("[T]-Tenant  NEWLINE [A]-Apartment  NEWLINE [P]-Transaction  NEWLINE [L]-Leave NEWLINE Choose a category:)
        GET category
        IF category IS IN  ("T","t") THEN
            
        ELSE IF category IS IN  ("A","a") THEN

        ELSE IF category IS IN  ("P","p") THEN

        ELSE IF category IS IN  ("L","l") THEN
            RETURN FALSE
        ELSE:
            code = 0
            CALLFUNCTION message(code)
        ENDIF
    ENDWHILE
ENDFUNCTION

FUNCTION search()
    WHILE TRUE
        PRINT("[T]-Tenant  NEWLINE [A]-Apartment  NEWLINE [P]-Transaction  NEWLINE [L]-Leave NEWLINE Choose a category:)
        GET category
        IF category IS IN  ("T","t") THEN
            
        ELSE IF category IS IN  ("A","a") THEN
            searchinformation(num)
        ELSE IF category IS IN  ("P","p") THEN

        ELSE IF category IS IN  ("L","l") THEN
            RETURN FALSE
        ELSE:
            code = 0
            CALLFUNCTION message(code)
        ENDIF
    ENDWHILE
ENDFUNCTION

FUNCTION transactionEntryForm()
ENDFUNCTION

FUNCTION log()
ENDFUNCTION

FUNCTION tenantRead()
    OPENFILE (tenant.txt) IN READ MODE AS fTenant
        tenantList = READ fTenant LINE-BY-LINE
        FOR record IN tenantList
            PRINT(record RIGHTSTRIP(",") RIGHTSTRIP("\n"))
        ENDFOR
    CLOSEFILE
ENDFUNCTION

FUNCTION tenantEntryForm(tenantlist,n)
    for i in range(n)
        newForm=[]
        name = CALL FUNCTION getname()
        gender = CALLFUNCTION getgender()
        pNum = CALLFUNCTION getpNum()
        nationality = CALLFUNCTION getnationality()
        startDate = CALLFUNCTION getstartDate()
        income = CALLFUNCTION getincome()
        rental = CALLFUNCTION getrental()
        APPEND [name,gender,pNum,nationality,startDate,income,rental] TO tenantList
    RETURN tenantList
ENDFUNCTION

FUNCTION getname()
    WHILE TRUE
        PRINT("Enter tenant name: Firstname Familyname Lastname"\n)
        GET name
        nameCheck = name
        SPLIT nameCheck INTO LIST WITH ","
        FOR words IN nameCheck
            IF characters IN words LOCATION 0 IS UPPERCASE THEN
                BREAKLOOP
            ELSE THEN
                code = 2
                CALLFUNCTION message(code)
            ENDIF
        ENDFOR
    ENDWHILE
    RETURN name
ENDFUNCTION

FUNCTION getgender()
    PRINT("Enter tenant gender: (m/f):\n")
    GET gender
    genderCheck = gender
    IF genderCheck LENGTH == 1 THEN
        IF genderCheck IS NOT A NUMBER THEN
            BREAKLOOP
        ELSE THEN
            code = 1
            CALLFUNCTION message(code)
    ELSE:
        code = 3
        CALLFUNCTION message(code)
    RETURN gender
ENDFUNCTION

FUNCTION getpNum():
    PRINT("Enter tenant phone number: (############):\n")
    GET pNum
    pNumCheck=pNum
    FOR digit IN pNum
        IF digit IS INTEGER THEN
            BREAKLOOP
        ELSE THEN
            code = 1
            CALLFUNCTION message(code)
        ENDIF
    ENDFOR
    RETURN pNum
ENDFUNCTION

FUNCTION getnationality():
    PRINT("Enter tenant nationality: (M: Malaysian/N: non-Malaysian):\n")
    GET nationality
    nationality = nationalityCheck
    IF nationalityCheck LENGTH = 1 THEN
        BREAKLOOP
    ELSE THEN 

    RETURN nationality
ENDFUNCTION

FUNCTION getstartDate():
    PRINT("Enter Rental start date: (YYYY,MM,DD):\n")
    GET startDate
    RETURN startDate
ENDFUNCTION

FUNCTION getincome():
    PRINT("Enter tenant income range(RM):\n")
    GET income
    RETURN income
ENDFUNCTION

FUNCTION getrental():
ENDFUNCTION

FUNCTION deleteTenant(recordName, recordNum)
    IF recordName==tenant
        OPEN "tenant.txt" IN READ MODE AS Thandler
            READ Thandler
            Thandler STRIP (",") 
            FOR record from list
                FOR item in record
                
FUNCTION searchTenant(details):
    OPEN "tenant.txt" IN READ MODE AS TSearch
        READ TSearch
        TSearch STRIP (",")
        list = JOIN TSearch INTO string(",")
        FOR record IN list
            IF record STARTS WITH details THEN
                PRINT("Found record", record RIGHTSTRIP(",") RIGHTSTRIP(""))
            ENDIF
        ENDFOR
    CLOSEFILE

FUNCTION appendFile(list, listBool)
    IF listBool == TRUE:
        OPEN "tenant.txt" IN APPEND AS Thandler
            for record from list:
                for item in record:
                    WRITE item TO Thandler
                    WRITE "\n" TO Thandler
                WRITE "\n" TO Thandler
    ELSE:
        OPEN "apartment.txt" IN APPEND AS Ahandler 
            for record from list:
                for item in record:
                    WRITE item TO Ahandler
                    WRITE "\n" TO Ahandler
                WRITE "\n" TO Ahandler
        CLOSE apartment.txt

FUNCTION read_file(listBool):
    IF listBool == TRUE:
        OPEN "tenant.txt" IN READ AS Thandler:
            FOR record FROM Ahandler:
                PRINT(record RIGHTSTRIP() RIGHTSTRIP(","))

    ELSE:
        OPEN "apartment.txt" IN READ AS Ahandler:
            FOR record FROM Ahandler:
                PRINT(record RIGHTSTRIP() RIGHTSTRIP(","))

FUNCTION message(code)
    IF code == 0:
        PRINT("Incorrect input")
    ELSE IF code == 1:
        PRINT("Incorrect data type present")
    ELSE IF code == 2:
        PRINT("Format error")
    ELSE IF code == 3:
        PRINT("Length error")
    PRINT("Please try again.")

--------------------------------------------------------------------------------------------------------------------------------------------------------------------

FUNCTION adminApartment():
    
    PRINT("NEWLINE Apartment Info: NEWLINE")
    record=[]

    list1=[["Standard Room (Triple)"],["Code: SR1"],["Dimensions: 140+ sqft"],["Pricing: RM350"],["Number of Rooms: 20"],["Apartment ID: A01-L1-R1 to A01-L1-R21"]]
    list2=[["Standard Room (Twin)"],["Code: SR2"],["Dimensions: 120+ sqft"],["Pricing: RM450"],["Number of Rooms: 20"],["Apartment ID: A01-L1-R22 to A01-L1-R41"]]
    list3=[["Standard Room A/C (Triple)"],["Code: SR3"],["Dimensions: 150+ sqft"],["Pricing: RM550"],["Number of Rooms: 20"],["Apartment ID: A01-L2-R1 to A01-L2-R21"]]
    list4=[["Standard Room A/C (Twin)"],["Code: SR4"],["Dimensions: 130+ sqft"],["Pricing: RM650"],["Number of Rooms: 20"],["Apartment ID: A01-L2-R22 to A01-L2-R41"]]
    list5=[["Deluxe Room (Triple)"],["Code: DR1"],["Dimensions: 170+ sqft"],["Pricing: RM750"],["Number of Rooms: 20"],["Apartment ID: A01-L4-R1 to A01-L4-R21"]]
    list6=[["Deluxe Room (Twin)"],["Code: DR2"],["Dimensions: 160+ sqft"],["Pricing: RM840"],["Number of Rooms: 20"],["Apartment ID: A01-L4-R22 to A01-L4-R41"]]
    list7=[["Deluxe Room A/C with shared attached bath / toilet (Triple)"],["Code: DR3"],["Dimensions: 180+ sqft"],["Pricing: RM950"],["Number of Rooms: 20"],["Apartment ID: A01-L3-R1 to A01-L3-R21"]]
    list8=[["Deluxe Room A/C with shared attached bath / toilet"],["Code: DR4"],["Dimensions: 170+ sqft"],["Pricing: RM1040"],["Number of Rooms: 20"],["Apartment ID: A01-L3-R22 to A01-L3-R41"]]
    list9=[["Compact Premium Single"],["Code: CPS"],["Dimensions: 130+ sqft"],["Pricing: RM690"],["Number of Rooms: 20"],["Apartment ID: A01-L5-R1 to A01-L5-R41"]]
    list10=[["Medium Premium Single"],["Code: MPS"],["Dimensions: 150+ sqft"],["Pricing: RM750"],["Number of Rooms: 20"],["Apartment ID: A02-L1-R1 to A02-L1-R21"]]
    list11=[["Medium Premium Twin"],["Code: MPT"],["Dimensions: 180+ sqft"],["Pricing: RM890"],["Number of Rooms: 20"],["Apartment ID: A02-L2-R1 to A02-L2-R21"]]
    list12=[["Medium Premium with attached bath / toilet (Twin)"],["Code: MP1"],["Dimensions: 180+ sqft"],["Pricing: RM940"],["Number of Rooms: 20"],["Apartment ID: A02-L3-R1 to A02-L3-R21"]]
    list13=[["Medium Premium with attached bath / toilet (Single)"],["Code: MP2"],["Dimensions: 160+ sqft"],["Pricing: RM1050"],["Number of Rooms: 20"],["Apartment ID: A02-L3-R22 to A02-L3-R41"]]
    list14=[["En-Suite Single (Super Premium - Triple)"],["Code: ESS3"],["Dimensions: 160+ sqft"],["Pricing: RM700"],["Number of Rooms: 20"],["Apartment ID: A02-L4-R1 to A02-L4-R41"]]
    list15=[["En-Suite Single (Super Premium - Twin)"],["Code: ESS2"],["Dimensions: 140+ sqft"],["Pricing: RM800"],["Number of Rooms: 20"],["Apartment ID: A02-L4-R1 to A02-L4-R41"]]
    list16=[["En-Suite Twin (Super Premium)"],["Code: EST2"],["Dimensions: 200+ sqft"],["Pricing: RM900"],["Number of Rooms: 20"],["Apartment ID: A02-L5-R1 to A02-L5-R41"]]
    APPEND [list1,list2,list3,list4,list5,list6,list7,list8,list9,list10,list11,list12,list13,list14,list15,list16] TO record

    OPEN "Apartment.txt" IN WRITE AS Ahandler
        for item in record:
            for data in item:
                for element in data:
                    WRITE element TO Ahandler
                WRITE ", " TO Ahandler
            WRITE "\n" TO Ahandler
    CLOSE apartment.txt

    OPEN "Apartment.txt" IN READ AS Ahandler
        for item in Ahandler:
            PRINT(item,RIGHTSTRIP() RIGHTSTRIP(","))
    CLOSE apartment.txt

    CALLFUNCTIONmodifydata()

ENDFUNCTION

FUNCTION modifydata():

    DECLARE dataInput AS INTEGER
    PRINT("NEWLINE 1. Add data NEWLINE 2. Edit Data NEWLINE 3. Delete Data NEWLINE 4. Exit NEWLINE")
    PRINT("Please select which operation: ")
    GET dataInput

    IF dataInput==1 THEN
        PRINT("NEWLINE Add Data NEWLINE")
        CALLFUNCTION apartmentAddData()

    ELSE IF dataInput==2 THEN
        PRINT("NEWLINE Add Data NEWLINE")
        CALLFUNCTION apartmentEditData()

    ELSE IF dataInput==3 THEN
        PRINT("NEWLINE Add Data NEWLINE")
        CALLFUNCTION apartmentDeleteData()

    ELSE IF dataInput==4 THEN
        PRINT("Exit")

    ELSE THEN
        PRINT("Error!")

ENDFUNCTION

FUNCTION apartmentAddData():
    
    DECLARE adddatanum,newapartmentnumberofrooms AS INTEGER
    DECLARE newapartment AS STRING
    adddata=[]
    PRINT("NEWLINE Now, you are required to enter the new data NEWLINE")
    FOR i FROM 0 to adddatanum
        PRINT("Apartment: ")
        GET newapartment
        PRINT("Code: ")
        PRINT("Dimension (in range): ")
        PRINT("")


ENDFUNCTION

FUNCTION searchbox():
    WHILE True
        DECLARE option AS INTEGER
        DECLARE opt AS STRING
        PRINT("NEWLINE Welcome to search box!")
        PRINT("NEWLINE 1. Search room specific details.NEWLINE 2. Search specific tenant details NEWLINE 4. Exit NEWLINE")
        PRINT("Please type the keyword search based on the listing above: ")
        GET option

        IF option=='1' THEN:
            PRINT("NEWLINE Room(r), Pricing(p)\nPlease type the keyword search based on the listing above: ")
            GET opt

            IF opt=='r' THEN
            PRINT("NEWLINE SR1,SR2,SR3,SR4,DR1,DR2,DR3,DR4,CPS,MPS,MPT,MP1,MP2,ESS3,ESS2,EST2")
            num=1
            CALLFUNCTION searchinformation(num)

            IF opt=='p' THEN
            PRINT("NEWLINE RM350,RM450,RM550,RM650,RM690,RM700,RM750,RM800,RM840,RM890,RM900,RM940,RM950,RM1040,RM1050")
            num=3
            CALLFUNCTION searchinformation(num)

            ELSE:
            PRINT("Invalid input or no records")
            PRINT("Continue? Enter 'C' NEWLINE Exit? Enter 'X' ")

        IF option=='2' THEN
            PRINT("NEWLINE Name(N),Apartment Details(A) NEWLINE Please type the keyword search based on the listing above: ")
            GET options

            IF options=='N' THEN
                PRINT()

            IF opt=='A' THEN
                PRINT()

            ELSE:
            PRINT("Invalid input or no records")

        IF option=='X' THEN
            PRINT(" NEWLINE Return to main menu NEWLINE NEWLINE --------------------------- ")
            RETURN FALSE

        ELSE:
            PRINT("NEWLINE Error! Please try again")
ENDFUNCTION

FUNCTION searchinformation(num)

    PRINT("Select and enter text to begin search: ")
    GET searchinformation
    PRINT()
    OPEN "Apartment.txt" IN READ AS Xhandler
            FOR record FROM Xhandler:
                strippeditem = record RIGHTSTRIP(",") RIGHTSTRIP("\n")
                data = SPLIT strippeditem INTO string(", ")
                IF searchinformation IN data[num]:
                    PRINT("Results: NEWLINE",record)

ENDFUNCTION

FUNCTION adminMenu()
    WHILE TRUE
        PRINT("\nTenant Management System")
        PRINT("\n1.Review information\n2. Search box\n3.Register new tenant \n4. Exit")
        PRINT("\nPlease select which operation that you want to do: ")
        GET opt
        IF opt == 1
            CALLFUNCTION display()

        ELSEIF opt == 2:
            CALLFUNCTION search()
            
        ELSEIF opt == 3:
            PRINT("Number of new tenants: ")
            GET n
            tenantlist=[]
            tenantlist = CALLFUNCTION tenantEntryForm(tenantlist,n)
            bool=TRUE
            appendFile(tenantlist,n)

        ELSEIF opt == 4:
            PRINT("\nThank you for using, have a nice day~")
            RETURN FALSE
        ELSE:
            PRINT("\nError! Please try again")
ENDFUNCTION

BEGIN
IMPORT datetime AS dt
CALLFUNCTION login()
END